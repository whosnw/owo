<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Malla Curricular – Ingeniería Química</title>
<link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">

<style>
body{
    font-family:'Open Sans',sans-serif;
    background:#121212;
    color:#eee;
    margin:0;
    padding:20px;
    display:flex;
}
.main{
    flex:3;
}
.sidebar{
    flex:1;
    margin-left:25px;
    background:#1e1e1e;
    border-radius:12px;
    padding:20px;
    box-shadow:0 6px 15px rgba(0,0,0,.4);
}
h1,h2,h3{
    text-align:center;
    color:#fce4ec;
}
.course{
    background:#333;
    border:1px solid #444;
    padding:10px;
    border-radius:8px;
    margin-bottom:8px;
    cursor:pointer;
}
.course.approved{
    background:#c5cae9;
    color:#1a237e;
    text-decoration:line-through;
}
.course.blocked{
    background:#fbe9e7;
    color:#bf360c;
    cursor:not-allowed;
}
.counter{
    background:#6a053c;
    padding:12px;
    border-radius:10px;
    margin-bottom:15px;
    font-weight:700;
    text-align:center;
}
</style>
</head>

<body>

<div class="main">
    <h1>Malla Curricular – Ingeniería Química</h1>
    <div id="curriculum"></div>
</div>

<div class="sidebar">
    <h2>Electivos</h2>
    <div id="elective-counter" class="counter"></div>
    <div id="electives"></div>

    <h2>Complementarios</h2>
    <div id="complementary-counter" class="counter"></div>
    <div id="complementary"></div>
</div>

<script>
// ================== CONFIGURACIÓN ==================
const MIN_ELECTIVE_CREDITS = 10;
const MAX_COMPLEMENTARY_CREDITS = 8;

// ================== DATOS ==================
const electivesData = [
 {id:"PI147",name:"Transferencia de Masa II",credits:3,prereq:["PI144"]},
 {id:"PI226",name:"Cinética Química y Diseño de Reactores II",credits:3,prereq:["PI225"]},
 {id:"PI322",name:"Electroquímica Industrial",credits:3,prereq:["QU428"]},
 {id:"PI366",name:"Polímeros II",credits:3,prereq:["PI365"]}
];

const complementaryData = [
 {id:"PA425",name:"Diseño y Evaluación de Proyectos",credits:4,prereq:["PI510"]},
 {id:"PA515",name:"Mercadotecnia",credits:2,prereq:[]},
 {id:"QU565",name:"Análisis Químico Instrumental I",credits:5,prereq:["QU518"]}
];

// ================== STORAGE ==================
let approvedElectives = JSON.parse(localStorage.getItem("approvedElectives_IQ"))||{};
let approvedComplementary = JSON.parse(localStorage.getItem("approvedComplementary_IQ"))||{};

// ================== FUNCIONES ==================
function renderList(data,container,approved,maxCredits){
    container.innerHTML="";
    let usedCredits=0;

    data.forEach(c=>{
        const div=document.createElement("div");
        div.className="course";
        if(approved[c.id]){
            div.classList.add("approved");
            usedCredits+=c.credits;
        }
        div.textContent=`${c.id} – ${c.name} (${c.credits} cr)`;

        div.onclick=()=>{
            if(approved[c.id]){
                delete approved[c.id];
            }else{
                if(maxCredits && usedCredits+c.credits>maxCredits){
                    alert("Supera el máximo permitido");
                    return;
                }
                approved[c.id]=true;
            }
            save();
            update();
        };
        container.appendChild(div);
    });
    return usedCredits;
}

function update(){
    const eCredits=renderList(electivesData,
        document.getElementById("electives"),
        approvedElectives);

    const cCredits=renderList(complementaryData,
        document.getElementById("complementary"),
        approvedComplementary,
        MAX_COMPLEMENTARY_CREDITS);

    document.getElementById("elective-counter").textContent=
        `Electivos: ${eCredits} / ${MIN_ELECTIVE_CREDITS} créditos`;

    document.getElementById("complementary-counter").textContent=
        `Complementarios: ${cCredits} / ${MAX_COMPLEMENTARY_CREDITS} créditos`;
}

function save(){
    localStorage.setItem("approvedElectives_IQ",JSON.stringify(approvedElectives));
    localStorage.setItem("approvedComplementary_IQ",JSON.stringify(approvedComplementary));
}

update();
</script>

</body>
</html>
